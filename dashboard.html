<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†ØµØ© Ø§Ù„ØªØ­Ø¯ÙŠ</title>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Tajawal',sans-serif;
  background:linear-gradient(180deg,#071a3a,#020617 80%);
  color:white;
  padding:20px;
}

/* Ø¹Ù†ÙˆØ§Ù† */
.title{
  font-size:26px;
  font-weight:900;
  margin-bottom:25px;
}

/* ÙƒØ§Ø±Øª Ø§Ù„Ù†Ù‚Ø§Ø· */
.score-card{
  background:linear-gradient(145deg,rgba(255,255,255,0.07),rgba(255,255,255,0.03));
  border-radius:25px;
  padding:25px;
  border:1px solid rgba(255,255,255,0.08);
  box-shadow:0 0 40px rgba(0,0,0,0.4);
  margin-bottom:25px;
}

.score-title{
  opacity:.8;
  font-size:18px;
}

.score-number{
  font-size:55px;
  font-weight:900;
  color:#facc15;
  margin:10px 0;
}

.progress{
  margin-top:10px;
  font-weight:700;
  color:#facc15;
}

/* Ø£Ø²Ø±Ø§Ø± */
.buttons{
  display:flex;
  gap:12px;
  margin-bottom:25px;
}

.btn{
  flex:1;
  padding:16px;
  border-radius:20px;
  font-weight:800;
  font-size:16px;
  border:none;
}

.btn-dark{
  background:rgba(255,255,255,0.06);
  color:white;
  border:1px solid rgba(255,255,255,0.1);
}

.btn-gold{
  background:linear-gradient(90deg,#facc15,#eab308);
  color:black;
  box-shadow:0 0 20px rgba(250,204,21,.5);
}

/* Ø§Ù„Ø£ÙŠØ§Ù… */
.day{
  padding:18px;
  border-radius:18px;
  margin-bottom:14px;
  font-weight:700;
}

.locked{
  background:rgba(255,255,255,0.05);
  opacity:.4;
}

.soon{
  background:#1e3a8a;
}

.active{
  background:linear-gradient(90deg,#facc15,#eab308);
  color:black;
  cursor:pointer;
}

.done{
  background:#064e3b;
}
</style>
</head>
<body>

<div class="title">ğŸ”¥ Ø³Ø§Ø­Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª</div>

<div class="score-card">
  <div class="score-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·</div>
  <div class="score-number" id="totalScore">0</div>
  <div class="progress" id="progressText">0 / 29 Ø¬ÙˆÙ„Ø©</div>
</div>

<div class="buttons">
  <button class="btn btn-dark">ğŸ‘‘ ÙØ±Ø³Ø§Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</button>
  <button class="btn btn-gold">ğŸ—º Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ø¹Ø§Ø±Ùƒ</button>
</div>

<div id="daysContainer"></div>

<script>
const firebaseConfig = {
  apiKey: "PUT-YOUR-KEY",
  authDomain: "PUT-YOUR-DOMAIN",
  projectId: "PUT-YOUR-ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

let user;
let myLogs = {};
let adminDay = 1;
let adminStatus = "closed";

auth.signInAnonymously();

auth.onAuthStateChanged(u=>{
  if(u){
    user=u;
    loadData();
  }
});

function loadData(){

  db.collection("users")
  .doc(user.uid)
  .collection("game_logs")
  .onSnapshot(snap=>{
    myLogs={};
    let total=0;

    snap.forEach(d=>{
      myLogs[d.data().day]=d.data().score;
      total+=d.data().score;
    });

    document.getElementById("totalScore").innerText=total;
    document.getElementById("progressText").innerText=
      Object.keys(myLogs).length+" / 29 Ø¬ÙˆÙ„Ø©";

    renderDays();
  });

  db.collection("settings")
  .doc("global_status")
  .onSnapshot(doc=>{
    if(doc.exists){
      adminDay=doc.data().currentDay;
      adminStatus=doc.data().status;
    }
    renderDays();
  });
}

function renderDays(){
  let html="";

  for(let i=1;i<=29;i++){

    if(myLogs[i]!==undefined){
      html+=`<div class="day done">âœ… Ø§Ù„Ø¬ÙˆÙ„Ø© ${i} - ${myLogs[i]} Ù†Ù‚Ø·Ø©</div>`;
    }
    else if(i===adminDay && adminStatus==="active"){
      html+=`<div class="day active" onclick="startQuiz(${i})">â–¶ Ø§Ù„Ø¬ÙˆÙ„Ø© ${i}</div>`;
    }
    else if(i===adminDay && adminStatus==="soon"){
      html+=`<div class="day soon">â³ Ø§Ù„Ø¬ÙˆÙ„Ø© ${i} Ù‚Ø±ÙŠØ¨Ø§Ù‹</div>`;
    }
    else{
      html+=`<div class="day locked">ğŸ”’ Ø§Ù„Ø¬ÙˆÙ„Ø© ${i}</div>`;
    }
  }

  document.getElementById("daysContainer").innerHTML=html;
}

function startQuiz(day){
  alert("ÙØªØ­ Ø§Ù„Ø¬ÙˆÙ„Ø© "+day);
}
</script>

</body>
</html>
