<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>كويز الرمضاني | تسجيل الدخول</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body { background-color: #030712; color: white; font-family: 'Cairo', sans-serif; display: flex; flex-direction: column; min-height: 100vh; align-items: center; justify-content: center; background-image: radial-gradient(circle at top, #112240, #030712); }
        .login-box { background: rgba(17, 24, 39, 0.8); border: 1px solid rgba(212, 175, 55, 0.3); backdrop-filter: blur(10px); box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
    </style>
</head>
<body class="p-4">

    <div class="login-box p-8 rounded-3xl w-full max-w-sm text-center">
        <img src="https://i.postimg.cc/9Fpp5TVC/IMG-20260217-031514.png" class="w-24 h-24 mx-auto rounded-full border-2 border-yellow-500 mb-6 shadow-[0_0_15px_rgba(212,175,55,0.5)]">
        <h1 class="text-2xl font-black text-yellow-500 mb-2">أهلاً بك يا بطل</h1>
        <p class="text-gray-400 text-sm mb-6">أدخل بياناتك للبدء في التحدي</p>

        <input type="text" id="login-name" placeholder="اسمك كاملاً..." class="w-full p-4 bg-gray-800 rounded-xl mb-4 text-white border border-gray-700 outline-none focus:border-yellow-500">
        <input type="password" id="login-pass" placeholder="كلمة السر..." class="w-full p-4 bg-gray-800 rounded-xl mb-6 text-white border border-gray-700 outline-none focus:border-yellow-500 text-center tracking-widest font-bold">
        
        <button onclick="loginUser()" id="login-btn" class="w-full bg-gradient-to-r from-yellow-600 to-yellow-500 text-black font-black py-4 rounded-xl shadow-lg hover:scale-105 transition text-lg">دخول الملعب ⚽</button>
        <p id="error-msg" class="text-red-500 text-xs mt-4 font-bold hidden"></p>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        const firebaseConfig = { apiKey: "AIzaSyBZMnIJ_IOqeAfXqFt-m4tM1Lvo0tUDnk8", projectId: "ramadan-87817", appId: "1:343525703258:web:6776b4857425df8bcca263" };
        if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
        const db = firebase.firestore();

        if (localStorage.getItem('currentUser')) window.location.replace('dashboard.html');

        function loginUser() {
            let n = document.getElementById('login-name').value.trim();
            let p = document.getElementById('login-pass').value.trim();
            let err = document.getElementById('error-msg');
            let btn = document.getElementById('login-btn');

            if (!n || !p) { err.innerText = "⚠️ برجاء كتابة الاسم وكلمة السر!"; err.classList.remove('hidden'); return; }

            btn.innerText = "جاري التحقق...";
            err.classList.add('hidden');

            db.collection("users").where("name", "==", n).where("password", "==", p).get()
            .then(snap => {
                if (snap.empty) {
                    err.innerText = "❌ البيانات خاطئة، راجع الإدارة!"; err.classList.remove('hidden'); btn.innerText = "دخول الملعب ⚽";
                } else {
                    let userData = snap.docs[0].data();
                    userData.id = snap.docs[0].id;
                    if (userData.isBanned) {
                        err.innerText = "⛔ حسابك محظور من اللعب!"; err.classList.remove('hidden'); btn.innerText = "دخول الملعب ⚽";
                    } else {
                        localStorage.setItem('currentUser', JSON.stringify(userData));
                        window.location.replace('dashboard.html');
                    }
                }
            }).catch(e => { err.innerText = "خطأ في الشبكة!"; err.classList.remove('hidden'); btn.innerText = "دخول الملعب ⚽"; });
        }
    </script>
</body>
</html>
